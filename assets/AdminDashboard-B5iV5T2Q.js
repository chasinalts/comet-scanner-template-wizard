import{j as e,m as f,A as V,R as me,a as ge}from"./vendor-ui-Bp3seDoC.js";import{a as d,R as ue}from"./vendor-react-Dyhn-Q9i.js";import{u as K,s as B,c as xe,b as pe,H as C}from"./index-BegOODW_.js";import{c as Y,h as X,a as he,b as be,u as ye,T as A,B as $,C as R,d as Q,S as J,i as fe}from"./Button-CyVQKkmn.js";const ve=()=>e.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},className:"relative w-8 h-8",children:e.jsx(f.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"absolute inset-0 border-2 border-blue-500 dark:border-blue-400 rounded-full border-t-transparent"})}),je=()=>e.jsx("svg",{className:"w-6 h-6 text-gray-400 dark:text-gray-500 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),ke=()=>e.jsx(f.svg,{initial:{scale:1},animate:{scale:[1,1.1,1]},transition:{duration:1.5,repeat:1/0},className:"w-8 h-8 text-blue-500 dark:text-blue-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m0-16l-4 4m4-4l4 4"})}),we=()=>e.jsx(f.svg,{initial:{scale:0},animate:{scale:1},className:"w-8 h-8 text-red-500 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});function z({onFileSelect:g,accept:n="image/*",maxSize:v=5,title:h="Upload File",description:I="Drag and drop a file here, or click to select",variant:N="default",isLoading:u=!1}){const[c,s]=d.useState(!1),[r,o]=d.useState(null),i=ue.useRef(null),m=b=>b.size>v*1024*1024?{type:"size",message:`File size exceeds ${v}MB limit`}:!n.includes("*")&&!n.includes(b.type)?{type:"type",message:"Invalid file type"}:null,x=d.useCallback(b=>{if(b.preventDefault(),s(!1),o(null),u)return;const k=b.dataTransfer.files[0];if(k){const w=m(k);if(w){o(w);return}g(k)}},[g,v,n,u]),T=d.useCallback(b=>{b.preventDefault(),u||(s(!0),o(null))},[u]),S=d.useCallback(b=>{b.preventDefault(),s(!1)},[]),j=()=>{u||(o(null),i.current?.click())},L=b=>{if(u)return;const k=b.target.files?.[0];if(k){const w=m(k);if(w){o(w);return}g(k)}b.target.value=""},p=N==="compact";return e.jsxs(f.div,{onClick:j,onDrop:x,onDragOver:T,onDragLeave:S,initial:{opacity:0},animate:{opacity:1,borderColor:c?"#3B82F6":r?"#EF4444":void 0,scale:c?1.02:1},transition:{duration:.2},className:`
        relative cursor-pointer
        ${p?"p-3":"p-6"}
        rounded-lg border-2 border-dashed
        ${u?"cursor-wait ":""}
        ${r?"border-red-500 bg-red-50 dark:bg-red-900/20":c?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}
        transition-colors duration-200
      `,children:[e.jsx("input",{ref:i,type:"file",accept:n,onChange:L,className:"hidden",disabled:u}),e.jsx(V,{mode:"wait",children:u?e.jsxs(f.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"absolute inset-0 flex flex-col items-center justify-center bg-white/50 dark:bg-gray-800/50 rounded-lg backdrop-blur-sm",children:[e.jsx(ve,{}),e.jsx(f.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},className:"text-blue-500 dark:text-blue-400 font-medium mt-2",children:"Uploading..."})]},"loading"):r?e.jsxs(f.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"absolute inset-0 flex flex-col items-center justify-center bg-red-50/50 dark:bg-red-900/30 rounded-lg backdrop-blur-sm",children:[e.jsx(we,{}),e.jsxs(f.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},className:"text-red-500 dark:text-red-400 font-medium text-center",children:[r.message,e.jsx("p",{className:"text-sm mt-1 text-red-400 dark:text-red-300",children:"Click or drag a new file to try again"})]})]},"error"):c?e.jsxs(f.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"absolute inset-0 flex flex-col items-center justify-center bg-blue-50/50 dark:bg-blue-900/30 rounded-lg backdrop-blur-sm",children:[e.jsx(ke,{}),e.jsx(f.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},className:"text-blue-500 dark:text-blue-400 font-medium",children:"Drop to upload"})]},"dragging"):e.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`text-center ${p?"space-y-1":"space-y-2"}`,children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(je,{}),e.jsx("div",{className:`${p?"text-sm":"text-base"} font-medium text-gray-900 dark:text-white`,children:h}),e.jsx("p",{className:`${p?"text-xs":"text-sm"} text-gray-500 dark:text-gray-400`,children:I}),e.jsxs("p",{className:`${p?"text-xs":"text-sm"} text-gray-400 dark:text-gray-500`,children:["Max size: ",v,"MB"]})]})},"normal")})]})}const Ne=()=>{const[g,n]=d.useState(()=>{const s=localStorage.getItem("admin_contents");return s?JSON.parse(s):[]});d.useEffect(()=>{localStorage.setItem("admin_contents",JSON.stringify(g)),console.log("Contents saved to localStorage:",g)},[g]),d.useEffect(()=>()=>{g.forEach(s=>{if(s.imageUrl){const r=s.imageUrl.includes("firebasestorage.googleapis.com");Y(s.imageUrl,r)}})},[]);const v=d.useCallback(s=>{const r=`content-${Date.now()}`,o=Date.now(),i={...s,id:r,createdAt:o,updatedAt:o};return n(m=>[...m,i]),r},[]),h=d.useCallback((s,r)=>{n(o=>o.map(i=>i.id===s?{...i,...r,updatedAt:Date.now()}:i))},[]),I=d.useCallback(s=>{n(r=>{const o=r.find(i=>i.id===s);if(o?.imageUrl){const i=o.imageUrl.includes("supabase");Y(o.imageUrl,i)}return r.filter(i=>i.id!==s)})},[]),N=d.useCallback((s,r,o="Uploaded Image")=>(console.log(`Starting upload of ${r} image:`,{fileName:s.name,fileSize:s.size,fileType:s.type}),new Promise((i,m)=>{try{X(s,r,(x,T)=>{try{console.log(`Adding ${r} content with Supabase Storage URL`);const S=v({type:r,title:o,content:"",imageUrl:x,scale:1});console.log(`${r} image added with ID:`,S),i(S)}catch(S){console.error(`Error adding ${r} content:`,S),m(S)}},x=>{console.error(`Error uploading ${r} image to Supabase Storage:`,x),m(new Error(`Failed to upload to Supabase Storage: ${x.message}`))})}catch(x){console.error(`Error setting up ${r} image upload:`,x),m(x)}})),[v]),u=d.useCallback((s,r)=>{h(s,{scale:r})},[h]),c=d.useCallback((s,r)=>{h(s,{displayText:r})},[h]);return{contents:g,addContent:v,updateContent:h,deleteContent:I,uploadImage:N,updateImageScale:u,updateImageDisplayText:c}},Se=({className:g="",onClick:n})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`w-5 h-5 ${g}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",onClick:n,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),Ce=({id:g,src:n,alt:v,scale:h=1,onScaleChange:I,onDelete:N,className:u=""})=>{const[c,s]=d.useState(h),[r,o]=d.useState(!1);d.useEffect(()=>{s(h)},[h]);const i=m=>{const x=parseFloat(m.target.value);s(x),I(g,x)};return e.jsx("div",{className:`group border dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-sm hover:shadow-md transition-all duration-200 ${u}`,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:e.jsx("div",{className:"p-4 space-y-4",children:e.jsxs("div",{className:"relative aspect-video bg-gray-100 dark:bg-gray-700 rounded-lg overflow-hidden",children:[e.jsx("img",{src:n,alt:v,className:"w-full h-full object-contain transition-transform duration-200",style:{transform:`scale(${c})`}}),e.jsx("button",{onClick:()=>N(g),className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Delete image",children:e.jsx(Se,{className:"w-4 h-4"})}),e.jsxs("div",{className:`absolute bottom-0 left-0 right-0 bg-black/50 backdrop-blur-sm p-2 transition-opacity duration-200 ${r?"opacity-100":"opacity-0"}`,children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-white text-xs",children:"Small"}),e.jsx("input",{type:"range",min:"0.5",max:"2",step:"0.1",value:c,onChange:i,className:"flex-grow h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700"}),e.jsx("span",{className:"text-white text-xs",children:"Large"})]}),e.jsxs("div",{className:"text-center text-white text-xs mt-1",children:[Math.round(c*100),"%"]})]})]})})})},Ie=()=>{const[g,n]=d.useState(""),[v,h]=d.useState({}),[I,N]=d.useState([]),[u,c]=d.useState(""),[s,r]=d.useState(!1),{currentUser:o}=K(),i=async()=>{if(!g.trim()){c("Template name cannot be empty.");return}r(!0),c("");try{if(o){const{error:m}=await B.from("templates").insert([{user_id:o.id,template_name:g,template_data:v}]);if(m)throw m;n(""),h({});const{data:x,error:T}=await B.from("templates").select("*").eq("user_id",o.id).order("created_at",{ascending:!1});if(!T){const S=(x||[]).map(j=>({id:j.id,template_name:j.template_name,template_data:j.template_data,created_at:j.created_at}));N(S)}}}catch{c("Failed to save template.")}finally{r(!1)}};return d.useEffect(()=>{(async()=>{if(o){r(!0);try{const{data:x,error:T}=await B.from("templates").select("*").eq("user_id",o.id).order("created_at",{ascending:!1});if(T)throw T;const S=(x||[]).map(j=>({id:j.id,template_name:j.template_name,template_data:j.template_data,created_at:j.created_at}));N(S)}catch{c("Failed to load templates.")}finally{r(!1)}}})()},[o]),e.jsxs("div",{className:"p-4",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Create a New Template"}),u&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert",children:e.jsx("span",{className:"block sm:inline",children:u})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"template_name",className:"block text-gray-700 text-sm font-bold mb-2",children:"Template Name"}),e.jsx("input",{type:"text",id:"template_name",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:g,onChange:m=>n(m.target.value),placeholder:"Enter template name"})]}),e.jsx("button",{onClick:i,disabled:s,className:`bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline ${s?"opacity-50 cursor-not-allowed":""}`,children:s?"Saving...":"Save Template"}),e.jsx("h3",{className:"text-lg font-bold mt-6",children:"Your Templates"}),s?e.jsx("p",{children:"Loading templates..."}):I.length===0?e.jsx("p",{children:"No templates found."}):e.jsx("ul",{children:I.map(m=>e.jsx("li",{className:"mt-2 p-2 border rounded",children:e.jsxs("p",{className:"font-semibold",children:["Template Name: ",m.template_name]})},m.id))})]})};function Ue(){const{currentUser:g}=K(),{showToast:n}=xe(),{theme:v}=pe(),[h,I]=d.useState(!1);d.useEffect(()=>{(async()=>{const t=await fe();I(t)})()},[g]);const{questions:N,addQuestion:u,updateQuestion:c,deleteQuestion:s}=he(),{sections:r,addSection:o,updateSection:i,deleteSection:m,reorderSections:x}=be(),{deleteContent:T,uploadImage:S,updateImageScale:j,updateImageDisplayText:L}=Ne(),{getBannerImage:p,getScannerImages:b}=ye(),[k,w]=d.useState(null),[Z,M]=d.useState(null),[D,q]=d.useState(1),O=9,ee=a=>{const t=N.find(y=>y.id===a);if(!t)return;const l={id:`option-${Date.now()}`,text:"",value:"",scale:1};c(a,{options:[...t.options||[],l]}),n("success","New answer option added")},F=(a,t,l)=>{const y=N.find(E=>E.id===a);y&&c(a,{options:y.options?.map(E=>E.id===t?{...E,...l(E)}:E)})},ae=(a,t)=>l=>{F(a,t,()=>({text:l.target.value,value:l.target.value.toLowerCase()}))},te=(a,t)=>l=>{F(a,t,()=>({scale:parseFloat(l.target.value)}))},re=async(a,t,l)=>{if(k){n("error","Please wait for the current upload to complete");return}try{w({questionId:a,optionId:t}),X(l,"option",(y,E)=>{const H=N.find(_=>_.id===a);H&&(c(a,{options:H.options?.map(_=>_.id===t?{..._,imageUrl:y,imagePreview:E,scale:1}:_)}),n("success","Image uploaded successfully"),w(null))},y=>{console.error("Failed to upload option image:",y),n("error","Failed to upload image to Supabase Storage."),w(null)})}catch{n("error","Failed to upload image"),w(null)}},se=(a,t)=>{F(a,t,()=>({imageUrl:void 0,imagePreview:void 0,scale:void 0}))},le=(a,t)=>l=>{F(a,t,()=>({linkedSectionId:l.target.value||void 0}))},W=(a,t,l)=>{if(k){n("error","Please wait for the current upload to complete");return}try{w({contentType:t}),S(a,t,l).then(y=>{M(y),t==="scanner"&&(console.log("Scanner image uploaded with ID:",y),console.log("Current scanner images:",b())),n("success",`${l} uploaded successfully`),w(null)}).catch(y=>{n("error",`Failed to upload ${l.toLowerCase()} to Supabase Storage.`),console.error(`Error uploading ${l.toLowerCase()}:`,y),w(null)})}catch(y){n("error",`Failed to upload ${l.toLowerCase()}`),console.error(`Error setting up ${l.toLowerCase()} upload:`,y),w(null)}},ne=a=>{W(a,"banner","Banner Image")},oe=a=>{W(a,"scanner","Scanner Variation")},de=a=>t=>{const l=parseFloat(t.target.value);j(a,l),M(a)},ie=(a,t)=>{L(a,t)},G=a=>{T(a),Z===a&&M(null),n("success","Image deleted successfully")},ce=()=>{const a=b(),t=(D-1)*O;return a.slice(t,t+O)},U=()=>{const a=b().length;return Math.ceil(a/O)},P=a=>{q(a)};return g?.is_owner?e.jsxs("div",{className:`max-w-7xl mx-auto p-6 space-y-12 ${v==="dark"?"dark":""} futuristic-grid-bg`,children:[e.jsx(C,{text:"Admin Dashboard",as:"h1",variant:"title",className:"text-3xl font-bold mb-8"}),e.jsxs("section",{className:"space-y-8",children:[e.jsx(C,{text:"Image Management",as:"h2",variant:"subtitle",className:"text-2xl font-semibold"}),e.jsxs("div",{className:"rounded-xl shadow-lg p-6 border border-gray-200 dark:border-gray-700 futuristic-container holo-glow",children:[e.jsx(C,{text:"Banner Image",as:"h3",variant:"subtitle",className:"text-xl font-medium mb-4"}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:p()?e.jsx("div",{className:"relative aspect-video bg-gray-100 dark:bg-gray-700 rounded-lg overflow-hidden",children:e.jsx("img",{src:p()?.src,alt:p()?.alt||"Banner image",className:"w-full h-full object-contain",style:{transform:`scale(${p()?.scale||1})`}})}):e.jsx("div",{className:"aspect-video bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center",children:e.jsx(C,{text:"No banner image uploaded",as:"p",className:"text-gray-500 dark:text-gray-400"})})}),p()&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{text:`Image Scale (${((p()?.scale||1)*100).toFixed(0)}%)`,as:"label",className:"block text-sm font-medium text-cyan-300 mb-1"}),e.jsx("input",{type:"range",min:"0.1",max:"2",step:"0.1",value:p()?.scale||1,onChange:de(p()?.id||""),className:"w-full"},`banner-scale-${p()?.id}-${p()?.scale}`)]}),e.jsxs("div",{children:[e.jsx(C,{text:"Display Text",as:"label",className:"block text-sm font-medium text-cyan-300 mb-1"}),e.jsx(A,{value:p()?.displayText||"",onChange:a=>ie(p()?.id||"",a.target.value),placeholder:"Enter text to display on the banner",className:"w-full"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx($,{variant:"danger",size:"sm",onClick:()=>G(p()?.id||""),children:"Remove Banner Image"})})]})]}),e.jsx("div",{children:h?e.jsx(z,{onFileSelect:ne,accept:"image/*",title:"Upload Banner Image",description:"Drag and drop or click to upload a banner image",maxSize:5,isLoading:k?.contentType==="banner"}):e.jsx("div",{className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg text-center",children:e.jsx(C,{text:"Only owners can upload media",as:"p",className:"text-amber-500"})})})]})})]}),e.jsxs("div",{className:"rounded-xl shadow-lg p-6 border border-gray-200 dark:border-gray-700 futuristic-container holo-glow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(C,{text:"Scanner Variations",as:"h3",variant:"subtitle",className:"text-xl font-medium"}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[b().length," images"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[ce().map(a=>e.jsx(Ce,{id:a.id,src:a.src,alt:a.alt,scale:a.scale||1,onScaleChange:(t,l)=>j(t,l),onDelete:G},a.id)),h?e.jsx("div",{className:"border dark:border-gray-700 rounded-lg shadow-sm p-4 futuristic-container",children:e.jsx(z,{onFileSelect:oe,accept:"image/*",title:"Add Scanner Variation",description:"Drag and drop or click to upload",maxSize:5,isLoading:k?.contentType==="scanner"})}):e.jsx("div",{className:"border dark:border-gray-700 rounded-lg shadow-sm p-4 futuristic-container text-center",children:e.jsx(C,{text:"Only owners can upload media",as:"p",className:"text-amber-500"})})]}),U()>1&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsxs("nav",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>P(Math.max(1,D-1)),disabled:D===1,className:`px-3 py-1 rounded ${D===1?"bg-gray-100 text-gray-400 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}`,children:"Previous"}),Array.from({length:U()},(a,t)=>t+1).map(a=>e.jsx("button",{onClick:()=>P(a),className:`w-8 h-8 rounded flex items-center justify-center ${a===D?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}`,children:a},a)),e.jsx("button",{onClick:()=>P(Math.min(U(),D+1)),disabled:D===U(),className:`px-3 py-1 rounded ${D===U()?"bg-gray-100 text-gray-400 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}`,children:"Next"})]})})]})]})]}),e.jsxs("section",{className:"space-y-8",children:[e.jsx(C,{text:"Full Template Code",as:"h2",variant:"subtitle",className:"text-2xl font-semibold"}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(C,{text:"Complete Pre-defined Template",as:"h3",variant:"subtitle",className:"text-xl font-medium"}),e.jsx(R,{label:"Make Available to Users",checked:localStorage.getItem("fullTemplateEnabled")==="true",onChange:a=>{localStorage.setItem("fullTemplateEnabled",a.target.checked.toString()),n("success",`Full template ${a.target.checked?"enabled":"disabled"} for users`)}})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:'This is the complete template code that will be provided to users who choose the "Full Template" option.'}),e.jsx(Q,{value:localStorage.getItem("fullTemplateCode")||"// Enter your complete template code here",onChange:a=>{localStorage.setItem("fullTemplateCode",a.target.value),n("success","Full template code saved")},className:"w-full font-mono text-sm text-gray-900 dark:text-white bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600",rows:15,placeholder:"Enter the complete template code here..."})]})]}),e.jsxs("section",{className:"space-y-8",children:[e.jsx(C,{text:"Template Builder",as:"h2",variant:"subtitle",className:"text-2xl font-semibold"}),e.jsx(Ie,{}),e.jsxs("div",{className:"space-y-6",children:[e.jsx($,{onClick:o,children:"Add New Section"}),e.jsx(me,{axis:"y",values:r,onReorder:x,className:"space-y-4",children:r.map(a=>e.jsxs(ge,{value:a,className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(A,{value:a.title,onChange:t=>i(a.id,{title:t.target.value}),className:"text-lg font-medium text-gray-900 dark:text-white bg-white dark:bg-gray-800",placeholder:"Section Title"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(R,{label:"Mandatory",checked:a.isMandatory,onChange:t=>i(a.id,{isMandatory:t.target.checked})}),e.jsx($,{variant:"danger",size:"sm",onClick:()=>m(a.id),children:"Delete Section"})]})]}),e.jsx(Q,{value:a.code,onChange:t=>i(a.id,{code:t.target.value}),className:"w-full font-mono text-sm text-gray-900 dark:text-white bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600",rows:5,placeholder:"Enter section code here..."})]},a.id))})]})]}),e.jsxs("section",{className:"space-y-8",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Questions"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsx($,{onClick:()=>u("text"),children:"Add Text Question"}),e.jsx($,{onClick:()=>u("choice"),children:"Add Choice Question"}),e.jsx($,{onClick:()=>u("boolean"),children:"Add Yes/No Question"})]}),e.jsx(V,{mode:"popLayout",children:e.jsx(f.div,{className:"space-y-8",children:N.map(a=>e.jsxs(f.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.95},className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx(Q,{value:a.text,onChange:t=>c(a.id,{text:t.target.value}),className:"w-full text-lg font-medium text-gray-900 dark:text-white bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600",placeholder:"Enter your question..."}),e.jsx($,{variant:"danger",size:"sm",onClick:()=>s(a.id),className:"ml-4",children:"Delete"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsx(R,{label:"Required Question",checked:a.required,onChange:t=>c(a.id,{required:t.target.checked})}),(a.type==="text"||a.type==="boolean")&&e.jsxs(J,{label:"Link to Code Section",value:a.linkedSectionId||"",onChange:t=>c(a.id,{linkedSectionId:t.target.value||void 0}),className:"text-gray-900 dark:text-white bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600",children:[e.jsx("option",{value:"",children:"None"}),r.map(t=>e.jsx("option",{value:t.id,children:t.title||`Section ${t.id}`},t.id))]})]}),a.type==="text"&&e.jsx(A,{label:"Placeholder Variable Name",value:a.placeholderVariable||"",onChange:t=>c(a.id,{placeholderVariable:t.target.value}),placeholder:"e.g., {{USER_INPUT}}",className:"text-gray-900 dark:text-white bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 mb-6"}),a.type==="choice"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Answer Options"}),e.jsx($,{onClick:()=>ee(a.id),children:"Add Option"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:e.jsx(V,{mode:"popLayout",children:a.options?.map(t=>e.jsx(f.div,{layout:!0,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"group border dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-sm hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(A,{label:"Option Text",value:t.text,onChange:ae(a.id,t.id),placeholder:"Enter answer option text",className:"text-gray-900 dark:text-white bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600"}),e.jsxs(J,{label:"Link to Code Section",value:t.linkedSectionId||"",onChange:l=>le(a.id,t.id)(l),className:"text-gray-900 dark:text-white bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600",children:[e.jsx("option",{value:"",children:"None"}),r.map(l=>e.jsx("option",{value:l.id,children:l.title||`Section ${l.id}`},l.id))]}),e.jsx("div",{className:"pt-4",children:t.imageUrl?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"relative aspect-video bg-gray-100 dark:bg-gray-800 rounded-lg overflow-hidden",children:e.jsx("img",{src:t.imagePreview||t.imageUrl,alt:t.text||"Option image",className:"w-full h-full object-contain",style:{transform:`scale(${t.scale||1})`}})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Image Scale (",((t.scale||1)*100).toFixed(0),"%)"]}),e.jsx("input",{type:"range",min:"0.1",max:"2",step:"0.1",value:t.scale||1,onChange:te(a.id,t.id),className:"w-full"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx($,{variant:"danger",size:"sm",onClick:()=>se(a.id,t.id),children:"Remove Image"})})]}):h?e.jsx(z,{onFileSelect:l=>re(a.id,t.id,l),accept:"image/*",title:"Add Answer Image",description:"Drag and drop or click to upload",maxSize:2,variant:"compact",isLoading:k?.questionId===a.id&&k?.optionId===t.id}):e.jsx("div",{className:"p-2 border border-gray-200 dark:border-gray-700 rounded-lg text-center",children:e.jsx("p",{className:"text-amber-500 text-sm",children:"Only owners can upload media"})})})]})},t.id))})})]})]},a.id))})})]})]})]}):e.jsx("div",{className:"p-8 text-center",children:e.jsx(C,{text:"You don't have permission to access this page.",as:"p",variant:"subtitle",className:"text-center"})})}export{Ue as default};
